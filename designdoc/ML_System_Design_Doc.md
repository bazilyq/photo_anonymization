# ML System Design Doc - [RU]
Design Doc к проекту photo_anonimization для курса ML System Design
*Шаблон ML System Design Doc от телеграм-канала [Reliable ML](https://t.me/reliable_ml)*   
    
### 1. Цели проекта
#### 1.1. Зачем идем в разработку продукта?  

- Цель: создание бота получающего на вход изображение содержащее человеческие лица и возвращающего.
- Критерий успешности: воспроизводимый, рабочий код для функционирующего бота

#### 1.2. Бизнес-требования и ограничения

- бот поддерживающий не более 10 обращений различных пользователей одновременно
- возврат результата работы модели не более чем через 15 секунд после получения
- MVP бота корректно обрабатывающего более 50 процентов входящих изображений 
- успешным пилотом считаем общедоступного бота в тг выдерживающего описанную нагрузку

#### 1.3. Что входит в скоуп проекта/итерации, что не входит

- Входит:
    - поддержка зависимостей и воспроизводимость проекта из текущего репозитория
    - поддержка структуры проекта
    - сохранение весов модели (вне репозитория при большом объеме)

- Не входит:
    - описание сценариев работы бота кроме целевого и /help
    - сохранение логов
    - контейнеризация

#### 1.4. Предпосылки решения

### 2. Методология     

#### 2.1. Постановка задачи  

- строим модель детекции объектов (лиц), к найденному блоку применяем фильтр с шумом

#### 2.2. Блок-схема решения 

#### 2.3. Этапы решения задачи `Data Scientist`  

**Этап 0 - Поиск подходящего датасета**

- Анализ технических ограничений к объемам данных, поиск данных с разметкой

**Этап 1 - Анализ существующих решений и выбор модели**

- анализ существующих библиотек, моделей, предобученных весов для задачи bject detection
- выбор железа для обучения

**Этап 2 - Обучение и валидация**

- валидация найденного датасета, подбор метрик, подбор гиперпараметров
- по достижении результата сохранение весов моделей и написание модуля для вызова с помощью бота
- подбор фильтра для блюра изображений, включение его функционала в упомянутый модуль

#### 2.3. Этапы решения задачи `Разработчик`  

**Этап 0 - Изучение существующих решений по разработке ботов**

- выбор библиотеки для построения бота

**Этап 1 - Написание бота с двумя сценариями**

- написание скрипта для бота с учетом необходимости принимать и отправлять фотографии

### 3. Подготовка пилота  

#### 3.1. Способ оценки пилота  
- Блок DS
  - обработка фотографий и детекция лиц людей на них
  - наложение фильтра на обнаруженные области
  - корректная работа модели, если лицо на фотографии не было найдено
  
- Блок разработчика бота
    - поддержка нескольких пользователей
    - исключение возможности перемешивания выводов для них

#### 3.2. Что считаем успешным пилотом
- воспризводимое, работающее решение с учетом вышеперечисленного

#### 4.2. Описание инфраструктуры и масштабируемости
- На момент запуска пилота работы с локальной файловой системой/файловой системой на сервере достаточно. При необходимости сохранять изображения длительное время можно подключить S3 хранилище.

#### 4.3. Требования к работе системы 
- поддержка сообщений от нескольких пользователей
  
#### 4.4. Безопасность системы 
- хранение токенов вне репозитория
  
#### 4.5. Безопасность данных   
  
- используется id сессии для обмена файлами, таким образом пользователь защищен от передачи своих данных при одновременной сессии нескольких
  
#### 4.6. Издержки  
  
- Обучение/дообучение модели приходится очуществлать на облачных сервисах с GPU    
  
#### 4.7. Риски  
  
- атаки на сервер извне
